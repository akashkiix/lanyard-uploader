<!DOCTYPE html>
<html>
  <head>
    <title>Upload Design</title>
  </head>
  <body>
    <h3>Upload your Lanyard Design</h3>
    <input type="file" id="imageInput" accept="image/*" />

    <script>
      const input = document.getElementById("imageInput");

      input.onchange = async () => {
        const file = input.files[0];
        const reader = new FileReader();

        reader.onloadend = async () => {
          const base64 = reader.result.split(',')[1];
          const formData = new FormData();
          formData.append("image", base64);

          const res = await fetch("https://api.imgbb.com/1/upload?key=ffd80c6acfd7fb50fea9f018e8542ae2", {
            method: "POST",
            body: formData
          });

          const data = await res.json();
          const imageUrl = data.data.url;

          console.log("âœ… Uploaded:", imageUrl);
          // Send image URL to Wix Studio
          parent.postMessage({ type: "imageUploaded", imageUrl }, "*");
        };

        reader.readAsDataURL(file);
      };
    </script>
  </body>
</html>
